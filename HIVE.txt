Hive

##CREAMOS LAS TABLAS
CREATE EXTERNAL TABLE PRUEBA_TW (
id Int,
screenName String,
name String,
createdAt String,
text String,
location String,
retweet Boolean)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\u0001'
STORED AS TEXTFILE;

##DAMOS PERMISOS A LA DIRECTORIO
hdfs dfs -chmod 777 procesados/m_3

##SUBIMOS DATOS DESDE HDFS
LOAD DATA INPATH "/user/acerrato/procesados/m_3"
INTO TABLE PRUEBA_TW;

##CUENTA TOTAL TW
SELECT COUNT(1)
FROM PRUEBA_TW;

##CUENTA TWEETS POR USER
SELECT ID, SCREENNAME, COUNT (1)
FROM PRUEBA_TW
WHERE ID IS NOT NULL
GROUP BY ID, SCREENNAME
ORDER BY COUNT (1) DEC
LIMIT 10;

##CREAR VISTAS
CREATE VIEW NGRAMAS_TW AS
SELECT TEXT
FROM PRUEBA_TW;

CREATE TABLE TABLE_GRAMAS AS SELECT * FROM NGRAMAS_TW;

##DI-GRAMAS
SELECT EXPLODE (NGRAMS(SENTENCES (LOWER (text)), 2, 20)) AS NGRAM
FROM TABLE_GRAMAS;

##TRI-GRAMAS
SELECT EXPLODE (NGRAMS(SENTENCES (LOWER (TEXT)), 3, 10)) AS NGRAM
FROM TABLE_GRAMAS;

